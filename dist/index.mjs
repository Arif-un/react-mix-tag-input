"use client";
import L,{forwardRef as R,useEffect as E,useImperativeHandle as b,useRef as T}from"react";var f="mtag";function d(i){var a;if(!i)return[];let u=Array.from(i),e=[];for(let s=0;s<u.length;s+=1){let n=u[s],l=e.at(-1);if(n instanceof Node&&n.nodeName==="#text"&&n.textContent!==`
`&&n.textContent!==""&&(typeof l=="string"?e[e.length-1]=l+n.textContent:e.push(n.textContent||"")),n instanceof HTMLElement&&n.nodeName==="SPAN"){let r=(a=n==null?void 0:n.classList)==null?void 0:a.value.replace(f,"").trim();e.push({type:"tag",label:n.innerHTML||n.innerText,...r?{classes:r}:{}})}}return e}function g(i){return!Array.isArray(i)||i.length===0?"":i.reduce((u,e)=>{if(typeof e=="string")return u+=e;if(typeof e=="object"){let{label:a,classes:s}=e;return u+=`<span class="${f} ${s||""}" contenteditable="false">${a}</span>`}return""},"")}var h=R((i,u)=>{let{onChange:e,value:a,multiline:s,...n}=i,l=T(g(a)),r=T(null);E(()=>{r.current&&(r.current.innerHTML=g(a))},[a]);let I=t=>{var m,M,y;let c=window.getSelection();if(!c)return;let x=c.getRangeAt(0);x.deleteContents();let o;if(typeof t=="string"?(o=document.createTextNode(t),o.textContent=t):typeof t=="object"&&t.type==="tag"&&(o=document.createElement("span"),o.classList.add(f),t.classes&&o.classList.add(t.classes),o.setAttribute("contentEditable","false"),o.innerHTML=t.label),!o){console.error("invalid content");return}x.insertNode(o);let p=document.createRange();p.setStartAfter(o),p.setEndAfter(o),c.removeAllRanges(),c.addRange(p),(m=r.current)==null||m.focus(),l.current=((M=r.current)==null?void 0:M.innerHTML)??"",e==null||e(d((y=r.current)==null?void 0:y.childNodes))};return b(u,()=>({inputRef:r.current,insertContent:I,getValue:()=>{var t;return d((t=r.current)==null?void 0:t.childNodes)}})),L.createElement("div",{"aria-label":"input",role:"textbox",tabIndex:0,className:"mix-tag-input",contentEditable:!0,ref:r,onInput:()=>{var t;r.current&&(l.current=r.current.innerHTML),e==null||e(d((t=r.current)==null?void 0:t.childNodes))},onKeyDown:t=>{t.key==="Enter"&&!s&&t.preventDefault()},dangerouslySetInnerHTML:{__html:l.current},...s?{"aria-multiline":!0}:{},...n})}),A=h;var F=A;export{F as default};
//# sourceMappingURL=index.mjs.map