"use client";
import L,{forwardRef as R,useEffect as E,useImperativeHandle as b,useRef as I}from"react";var p="mtag";function f(i){var a;if(!i)return[];let s=Array.from(i),e=[];for(let u=0;u<s.length;u+=1){let n=s[u],l=e.at(-1);if(n instanceof Node&&n.nodeName==="#text"&&n.textContent!==`
`&&n.textContent!==""&&(typeof l=="string"?e[e.length-1]=l+n.textContent:e.push(n.textContent||"")),n instanceof HTMLElement&&n.nodeName==="SPAN"){let r=(a=n==null?void 0:n.classList)==null?void 0:a.value.replace(p,"").trim();e.push({type:"tag",label:n.innerHTML||n.innerText,...r?{classes:r}:{}})}}return e}function x(i){return!Array.isArray(i)||i.length===0?"":i.reduce((s,e)=>{if(typeof e=="string")return s+=e;if(typeof e=="object"){let{label:a,classes:u}=e;return s+=`<span class="${p} ${u||""}" contenteditable="false">${a}</span>`}return""},"")}var h=R((i,s)=>{let{onChange:e,value:a,multiline:u,...n}=i,l=I(x(a)),r=I(null);E(()=>{r.current&&(r.current.innerHTML=x(a))},[a]);let A=t=>{var M,m,y;let c=window.getSelection();if(!c)return;let g=c.getRangeAt(0);g.deleteContents();let o;if(typeof t=="string"?(o=document.createTextNode(t),o.textContent=t):typeof t=="object"&&t.type==="tag"&&(o=document.createElement("span"),o.classList.add(p),t.classes&&o.classList.add(t.classes),o.setAttribute("contentEditable","false"),o.innerHTML=t.label),!o){console.error("invalid content");return}g.insertNode(o);let d=document.createRange();d.setStartAfter(o),d.setEndAfter(o),c.removeAllRanges(),c.addRange(d),(M=r.current)==null||M.focus(),l.current=((m=r.current)==null?void 0:m.innerHTML)??"",e==null||e(f((y=r.current)==null?void 0:y.childNodes))};return b(s,()=>({inputRef:r.current,insertContent:A,getValue:()=>{var t;return f((t=r.current)==null?void 0:t.childNodes)}})),L.createElement("div",{"aria-label":"input",role:"textbox",tabIndex:0,className:"mix-tag-input",contentEditable:!0,ref:r,onInput:()=>{var t;r.current&&(l.current=r.current.innerHTML),e==null||e(f((t=r.current)==null?void 0:t.childNodes))},onKeyDown:t=>{t.key==="Enter"&&!u&&t.preventDefault()},dangerouslySetInnerHTML:{__html:l.current},...u?{"aria-multiline":!0}:{},...n})}),T=h;var w=T;export{w as default};
//# sourceMappingURL=index.mjs.map