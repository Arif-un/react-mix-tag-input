"use client";
import b,{forwardRef as I,useEffect as T,useImperativeHandle as N,useRef as E}from"react";function y(r){return typeof r=="object"&&r.type==="tag"}function h(r){return{type:"tag",attrs:{...r.attrs}}}function l(r){let a=[];return r.forEach(t=>{var n;t.type==="paragraph"&&(a.push([]),(n=t==null?void 0:t.content)==null||n.forEach(e=>{var o,s;e.type==="text"&&e.text&&((o=a.at(-1))==null||o.push(e.text)),e.type==="tag"&&((s=a.at(-1))==null||s.push(h(e)))}))}),a}function d(r){let a=[];return r.forEach((t,n)=>{Array.isArray(a[n])||a.push({type:"paragraph",content:[]});let e=a.at(-1);typeof t=="string"&&(e!=null&&e.content)&&e.content.push({type:"text",text:t}),!Array.isArray(t)&&y(t)&&(e!=null&&e.content)&&e.content.push({type:"tag",attrs:{...t.attrs}}),Array.isArray(t)&&t.forEach(o=>{typeof o=="string"&&(e!=null&&e.content)&&e.content.push({type:"text",text:o}),typeof o=="object"&&o.type==="tag"&&(e!=null&&e.content)&&e.content.push({type:"tag",attrs:{...o.attrs}})})}),a}import{EditorContent as A,useEditor as C}from"@tiptap/react";import O from"@tiptap/extension-document";import R from"@tiptap/extension-paragraph";import P from"@tiptap/extension-text";import J from"@tiptap/extension-placeholder";import{mergeAttributes as M,Node as V}from"@tiptap/core";var f=V.create({name:"tag",group:"inline",inline:!0,atom:!0,selectable:!1,parseHTML(){return[{tag:`span[data-type="${this.name}"]`}]},renderHTML({HTMLAttributes:r}){return["span",M(r)]},addNodeView:()=>({node:r,extension:a})=>{let t=document.createElement("span");t.className="mi-tag",t.innerHTML=r.attrs.label,t.setAttribute("data-type","tag"),r.attrs.id&&t.setAttribute("data-id",r.attrs.id),a.options.tagClassName&&t.classList.add(a.options.tagClassName),r.attrs.class&&(Array.isArray(r.attrs.class)?r.attrs.class.forEach(e=>{t.classList.add(e)}):t.classList.add(r.attrs.class)),r.attrs.style&&Object.assign(t.style,r.attrs.style);let n=document.createElement("span");return n.appendChild(t),n.appendChild(document.createTextNode("\u200B")),{dom:n}},addAttributes(){return{label:void 0,id:void 0,class:void 0,style:void 0}}});var L=I((r,a)=>{let{onChange:t,value:n,placeholder:e,readonly:o=!1,tagClassName:s,...g}=r,u=E(null),i=C({editorProps:{attributes:{class:"mix-input"}},extensions:[O,R.configure({HTMLAttributes:{class:"mi-paragraph"}}),P,J.configure({placeholder:e}),f.configure({tagClassName:s})],onUpdate:({editor:p})=>{var c;t==null||t(l(((c=p==null?void 0:p.getJSON())==null?void 0:c.content)||[]))}}),m=p=>{i==null||i.chain().focus().insertContent(p).run()};return T(()=>{let p=d(n);JSON.stringify(p)!==JSON.stringify(i==null?void 0:i.getJSON().content)&&(i==null||i.commands.setContent(p))},[n]),N(a,()=>({editor:u.current,insertContent:m})),b.createElement(A,{editor:i,innerRef:u,...g})}),x=L;var W=x;export{W as default};
//# sourceMappingURL=index.mjs.map