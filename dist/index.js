"use client";
"use strict";var C=Object.create;var l=Object.defineProperty;var O=Object.getOwnPropertyDescriptor;var R=Object.getOwnPropertyNames;var P=Object.getPrototypeOf,J=Object.prototype.hasOwnProperty;var L=(t,a)=>{for(var e in a)l(t,e,{get:a[e],enumerable:!0})},m=(t,a,e,n)=>{if(a&&typeof a=="object"||typeof a=="function")for(let r of R(a))!J.call(t,r)&&r!==e&&l(t,r,{get:()=>a[r],enumerable:!(n=O(a,r))||n.enumerable});return t};var u=(t,a,e)=>(e=t!=null?C(P(t)):{},m(a||!t||!t.__esModule?l(e,"default",{value:t,enumerable:!0}):e,t)),S=t=>m(l({},"__esModule",{value:!0}),t);var w={};L(w,{default:()=>k});module.exports=S(w);var o=u(require("react"));function H(t){return typeof t=="object"&&t.type==="tag"}function j(t){return{type:"tag",attrs:{...t.attrs}}}function y(t){let a=[];return t.forEach(e=>{var n;e.type==="paragraph"&&(a.push([]),(n=e==null?void 0:e.content)==null||n.forEach(r=>{var p,c;r.type==="text"&&r.text&&((p=a.at(-1))==null||p.push(r.text)),r.type==="tag"&&((c=a.at(-1))==null||c.push(j(r)))}))}),a}function h(t){let a=[];return t.forEach((e,n)=>{Array.isArray(a[n])||a.push({type:"paragraph",content:[]});let r=a.at(-1);typeof e=="string"&&(r!=null&&r.content)&&r.content.push({type:"text",text:e}),!Array.isArray(e)&&H(e)&&(r!=null&&r.content)&&r.content.push({type:"tag",attrs:{...e.attrs}}),Array.isArray(e)&&e.forEach(p=>{typeof p=="string"&&(r!=null&&r.content)&&r.content.push({type:"text",text:p}),typeof p=="object"&&p.type==="tag"&&(r!=null&&r.content)&&r.content.push({type:"tag",attrs:{...p.attrs}})})}),a}var f=require("@tiptap/react"),V=u(require("@tiptap/extension-document")),b=u(require("@tiptap/extension-paragraph")),I=u(require("@tiptap/extension-text")),T=u(require("@tiptap/extension-placeholder"));var d=require("@tiptap/core"),M=d.Node.create({name:"tag",group:"inline",inline:!0,atom:!0,selectable:!1,parseHTML(){return[{tag:`span[data-type="${this.name}"]`}]},renderHTML({HTMLAttributes:t}){return["span",(0,d.mergeAttributes)(t)]},addNodeView:()=>({node:t,extension:a})=>{let e=document.createElement("span");e.className="mi-tag",e.innerHTML=t.attrs.label,e.setAttribute("data-type","tag"),t.attrs.id&&e.setAttribute("data-id",t.attrs.id),a.options.tagClassName&&e.classList.add(a.options.tagClassName),t.attrs.class&&(Array.isArray(t.attrs.class)?t.attrs.class.forEach(r=>{e.classList.add(r)}):e.classList.add(t.attrs.class)),t.attrs.style&&Object.assign(e.style,t.attrs.style);let n=document.createElement("span");return n.appendChild(e),n.appendChild(document.createTextNode("\u200B")),{dom:n}},addAttributes(){return{label:void 0,id:void 0,class:void 0,style:void 0}}});var v=(0,o.forwardRef)((t,a)=>{let{onChange:e,value:n,placeholder:r,readonly:p=!1,tagClassName:c,...E}=t,x=(0,o.useRef)(null),i=(0,f.useEditor)({editorProps:{attributes:{class:"mix-input"}},extensions:[V.default,b.default.configure({HTMLAttributes:{class:"mi-paragraph"}}),I.default,T.default.configure({placeholder:r}),M.configure({tagClassName:c})],onUpdate:({editor:s})=>{var g;e==null||e(y(((g=s==null?void 0:s.getJSON())==null?void 0:g.content)||[]))}}),A=s=>{i==null||i.chain().focus().insertContent(s).run()};return(0,o.useEffect)(()=>{let s=h(n);JSON.stringify(s)!==JSON.stringify(i==null?void 0:i.getJSON().content)&&(i==null||i.commands.setContent(s))},[n]),(0,o.useImperativeHandle)(a,()=>({editor:x.current,insertContent:A})),o.default.createElement(f.EditorContent,{editor:i,innerRef:x,...E})}),N=v;var k=N;
//# sourceMappingURL=index.js.map