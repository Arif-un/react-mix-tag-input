"use client";
"use strict";var j=Object.create;var l=Object.defineProperty;var D=Object.getOwnPropertyDescriptor;var F=Object.getOwnPropertyNames;var $=Object.getPrototypeOf,U=Object.prototype.hasOwnProperty;var W=(t,r)=>{for(var n in r)l(t,n,{get:r[n],enumerable:!0})},T=(t,r,n,o)=>{if(r&&typeof r=="object"||typeof r=="function")for(let e of F(r))!U.call(t,e)&&e!==n&&l(t,e,{get:()=>r[e],enumerable:!(o=D(r,e))||o.enumerable});return t};var d=(t,r,n)=>(n=t!=null?j($(t)):{},T(r||!t||!t.__esModule?l(n,"default",{value:t,enumerable:!0}):n,t)),_=t=>T(l({},"__esModule",{value:!0}),t);var Q={};W(Q,{default:()=>K,editorValueToMixInputValue:()=>x,mixInputValueToEditorValue:()=>m});module.exports=_(Q);var p=d(require("react"));function z(t){return typeof t=="object"&&t.type==="tag"}function B(t){return{type:"tag",attrs:{...t.attrs}}}function x(t){let r=[];return t.forEach(n=>{var o;n.type==="paragraph"&&(r.push([]),(o=n==null?void 0:n.content)==null||o.forEach(e=>{var i,c;e.type==="text"&&e.text&&((i=r.at(-1))==null||i.push(e.text)),e.type==="tag"&&((c=r.at(-1))==null||c.push(B(e)))}))}),r}function m(t){let r=[];return t.forEach((n,o)=>{Array.isArray(r[o])||r.push({type:"paragraph",content:[]});let e=r.at(-1);typeof n=="string"&&(e!=null&&e.content)&&e.content.push({type:"text",text:n}),!Array.isArray(n)&&z(n)&&(e!=null&&e.content)&&e.content.push({type:"tag",attrs:{...n.attrs}}),Array.isArray(n)&&n.forEach(i=>{typeof i=="string"&&(e!=null&&e.content)&&e.content.push({type:"text",text:i}),typeof i=="object"&&i.type==="tag"&&(e!=null&&e.content)&&e.content.push({type:"tag",attrs:{...i.attrs}})})}),r}var y=require("@tiptap/react"),A=d(require("@tiptap/extension-document")),E=d(require("@tiptap/extension-paragraph")),R=d(require("@tiptap/extension-text")),P=d(require("@tiptap/extension-placeholder"));var g=require("@tiptap/core"),I=require("@tiptap/react");var b=require("@tiptap/react"),f=d(require("react"));function V(t){let{tagView:r,tagClassName:n}=t.extension.options,{label:o,className:e,...i}=t.node.attrs;return f.default.createElement(f.default.Fragment,null,f.default.createElement(b.NodeViewWrapper,{"data-type":"tag",as:"span"},r?r(t):f.default.createElement("span",{className:`${n||""} ${e||""}`,...i},o)),"\u200B")}var N=g.Node.create({name:"tag",group:"inline",inline:!0,atom:!0,selectable:!1,parseHTML(){return[{tag:`span[data-type="${this.name}"]`}]},renderHTML({HTMLAttributes:t}){return["span",(0,g.mergeAttributes)(t)]},addNodeView(){return(0,I.ReactNodeViewRenderer)(V)},addAttributes(){let t={};for(let r in this.options.attrs)t[r]={default:this.options.attrs[r]};return t}});var G={id:void 0,label:"undefined",className:void 0,style:void 0},q=(0,p.forwardRef)((t,r)=>{let{onChange:n,value:o=[],placeholder:e,readonly:i=!1,tagClassName:c="mi-tag",editorOptions:C,className:O,tagAttrs:S,tagView:J,immediatelyRender:v=!0,...k}=t,h=(0,p.useRef)(null),M=(0,p.useRef)(""),a=(0,y.useEditor)({immediatelyRender:v,editorProps:{attributes:{class:`mix-input ${O||""}`}},extensions:[A.default,E.default.configure({HTMLAttributes:{class:"mi-paragraph"}}),R.default,P.default.configure({placeholder:e}),N.configure({tagClassName:c,attrs:{...G,...S},tagView:J})],onUpdate:({editor:u})=>{var s;n==null||n(x(((s=u==null?void 0:u.getJSON())==null?void 0:s.content)||[]))},...C}),H=u=>{a==null||a.chain().focus().insertContent(u).run()};return(0,p.useEffect)(()=>{if(!a)return;let u=m(o);u.length===0&&(u=[{type:"paragraph"}]);let s=JSON.stringify(u),L=JSON.stringify(a.getJSON().content);s!==L&&s!==M.current&&(M.current=s,setTimeout(()=>{a&&!a.isDestroyed&&a.commands.setContent(u)},0))},[o,a]),(0,p.useImperativeHandle)(r,()=>({element:h.current,editor:a,insertContent:H})),p.default.createElement(y.EditorContent,{editor:a,innerRef:h,...k})}),w=q;var K=w;0&&(module.exports={editorValueToMixInputValue,mixInputValueToEditorValue});
//# sourceMappingURL=index.js.map