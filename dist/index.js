"use client";
"use strict";var b=Object.create;var d=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var I=Object.getOwnPropertyNames;var N=Object.getPrototypeOf,H=Object.prototype.hasOwnProperty;var S=(t,n)=>{for(var e in n)d(t,e,{get:n[e],enumerable:!0})},L=(t,n,e,s)=>{if(n&&typeof n=="object"||typeof n=="function")for(let a of I(n))!H.call(t,a)&&a!==e&&d(t,a,{get:()=>n[a],enumerable:!(s=h(n,a))||s.enumerable});return t};var V=(t,n,e)=>(e=t!=null?b(N(t)):{},L(n||!t||!t.__esModule?d(e,"default",{value:t,enumerable:!0}):e,t)),v=t=>L(d({},"__esModule",{value:!0}),t);var _={};S(_,{default:()=>D});module.exports=v(_);var u=V(require("react"));var p="mtag";function g(t){var s;if(!t)return[];let n=Array.from(t),e=[];for(let a=0;a<n.length;a+=1){let o=n[a],c=e.at(-1);if(o instanceof Node&&o.nodeName==="#text"&&o.textContent!==`
`&&o.textContent!==""&&(typeof c=="string"?e[e.length-1]=c+o.textContent:e.push(o.textContent||"")),o instanceof HTMLElement&&o.nodeName==="SPAN"){let i=(s=o==null?void 0:o.classList)==null?void 0:s.value.replace(p,"").trim();e.push({type:"tag",label:o.innerHTML||o.innerText,...i?{classes:i}:{}})}}return e}function m(t){return!Array.isArray(t)||t.length===0?"":t.reduce((n,e)=>{if(typeof e=="string")return n+=e;if(typeof e=="object"){let{label:s,classes:a}=e;return n+=`<span class="${p} ${a||""}" contenteditable="false">${s}</span>`}return""},"")}var C=(0,u.forwardRef)((t,n)=>{let{onChange:e,value:s,multiline:a,...o}=t,c=(0,u.useRef)(m(s)),i=(0,u.useRef)(null);(0,u.useEffect)(()=>{i.current&&(i.current.innerHTML=m(s))},[s]);let E=r=>{var M,y,A;let f=window.getSelection();if(!f)return;let T=f.getRangeAt(0);T.deleteContents();let l;if(typeof r=="string"?(l=document.createTextNode(r),l.textContent=r):typeof r=="object"&&r.type==="tag"&&(l=document.createElement("span"),l.classList.add(p),r.classes&&l.classList.add(r.classes),l.setAttribute("contentEditable","false"),l.innerHTML=r.label),!l){console.error("invalid content");return}T.insertNode(l);let x=document.createRange();x.setStartAfter(l),x.setEndAfter(l),f.removeAllRanges(),f.addRange(x),(M=i.current)==null||M.focus(),c.current=((y=i.current)==null?void 0:y.innerHTML)??"",e==null||e(g((A=i.current)==null?void 0:A.childNodes))};return(0,u.useImperativeHandle)(n,()=>({inputRef:i.current,insertContent:E,getValue:()=>{var r;return g((r=i.current)==null?void 0:r.childNodes)}})),u.default.createElement("div",{"aria-label":"input",role:"textbox",tabIndex:0,className:"mix-tag-input",contentEditable:!0,ref:i,onInput:()=>{var r;i.current&&(c.current=i.current.innerHTML),e==null||e(g((r=i.current)==null?void 0:r.childNodes))},onKeyDown:r=>{r.key==="Enter"&&!a&&r.preventDefault()},dangerouslySetInnerHTML:{__html:c.current},...a?{"aria-multiline":!0}:{},...o})}),R=C;var D=R;
//# sourceMappingURL=index.js.map