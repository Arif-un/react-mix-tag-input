"use client";
"use strict";var E=Object.create;var d=Object.defineProperty;var b=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var N=Object.getPrototypeOf,H=Object.prototype.hasOwnProperty;var S=(t,n)=>{for(var e in n)d(t,e,{get:n[e],enumerable:!0})},I=(t,n,e,s)=>{if(n&&typeof n=="object"||typeof n=="function")for(let i of h(n))!H.call(t,i)&&i!==e&&d(t,i,{get:()=>n[i],enumerable:!(s=b(n,i))||s.enumerable});return t};var V=(t,n,e)=>(e=t!=null?E(N(t)):{},I(n||!t||!t.__esModule?d(e,"default",{value:t,enumerable:!0}):e,t)),v=t=>I(d({},"__esModule",{value:!0}),t);var _={};S(_,{default:()=>D});module.exports=v(_);var l=V(require("react"));var p="mtag";function g(t){var s;if(!t)return[];let n=Array.from(t),e=[];for(let i=0;i<n.length;i+=1){let o=n[i],c=e.at(-1);if(o instanceof Node&&o.nodeName==="#text"&&o.textContent!==`
`&&o.textContent!==""&&(typeof c=="string"?e[e.length-1]=c+o.textContent:e.push(o.textContent||"")),o instanceof HTMLElement&&o.nodeName==="SPAN"){let a=(s=o==null?void 0:o.classList)==null?void 0:s.value.replace(p,"").trim();e.push({type:"tag",label:o.innerHTML||o.innerText,...a?{classes:a}:{}})}}return e}function m(t){return!Array.isArray(t)||t.length===0?"":t.reduce((n,e)=>{if(typeof e=="string")return n+=e;if(typeof e=="object"){let{label:s,classes:i}=e;return n+=`<span class="${p} ${i||""}" contenteditable="false">${s}</span>`}return""},"")}var C=(0,l.forwardRef)((t,n)=>{let{onChange:e,value:s,multiline:i,...o}=t,c=(0,l.useRef)(m(s)),a=(0,l.useRef)(null);(0,l.useEffect)(()=>{a.current&&(a.current.innerHTML=m(s))},[s]);let R=r=>{var y,T,A;let f=window.getSelection();if(!f)return;let M=f.getRangeAt(0);M.deleteContents();let u;if(typeof r=="string"?(u=document.createTextNode(r),u.textContent=r):typeof r=="object"&&r.type==="tag"&&(u=document.createElement("span"),u.classList.add(p),r.classes&&u.classList.add(r.classes),u.setAttribute("contentEditable","false"),u.innerHTML=r.label),!u){console.error("invalid content");return}M.insertNode(u);let x=document.createRange();x.setStartAfter(u),x.setEndAfter(u),f.removeAllRanges(),f.addRange(x),(y=a.current)==null||y.focus(),c.current=((T=a.current)==null?void 0:T.innerHTML)??"",e==null||e(g((A=a.current)==null?void 0:A.childNodes))};return(0,l.useImperativeHandle)(n,()=>({inputRef:a.current,insertContent:R,getValue:()=>{var r;return g((r=a.current)==null?void 0:r.childNodes)}})),l.default.createElement("div",{"aria-label":"input",role:"textbox",tabIndex:0,className:"mix-tag-input",contentEditable:!0,ref:a,onInput:()=>{var r;a.current&&(c.current=a.current.innerHTML),e==null||e(g((r=a.current)==null?void 0:r.childNodes))},onKeyDown:r=>{r.key==="Enter"&&!i&&r.preventDefault()},dangerouslySetInnerHTML:{__html:c.current},...i?{"aria-multiline":!0}:{},...o})}),L=C;var D=L;
//# sourceMappingURL=index.js.map