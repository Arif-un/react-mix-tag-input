"use client";
"use strict";var H=Object.create;var g=Object.defineProperty;var R=Object.getOwnPropertyDescriptor;var P=Object.getOwnPropertyNames;var j=Object.getPrototypeOf,S=Object.prototype.hasOwnProperty;var J=(n,e)=>{for(var t in e)g(n,t,{get:e[t],enumerable:!0})},b=(n,e,t,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of P(e))!S.call(n,r)&&r!==t&&g(n,r,{get:()=>e[r],enumerable:!(o=R(e,r))||o.enumerable});return n};var x=(n,e,t)=>(t=n!=null?H(j(n)):{},b(e||!n||!n.__esModule?g(t,"default",{value:n,enumerable:!0}):t,n)),k=n=>b(g({},"__esModule",{value:!0}),n);var $={};J($,{default:()=>_});module.exports=k($);var u=x(require("react"));function w(n){return typeof n=="object"&&n.type==="tag"}function F(n){return{type:"tag",attrs:{...n.attrs}}}function T(n){let e=[];return n.forEach(t=>{var o;t.type==="paragraph"&&(e.push([]),(o=t==null?void 0:t.content)==null||o.forEach(r=>{var a,d;r.type==="text"&&r.text&&((a=e.at(-1))==null||a.push(r.text)),r.type==="tag"&&((d=e.at(-1))==null||d.push(F(r)))}))}),e}function V(n){let e=[];return n.forEach((t,o)=>{Array.isArray(e[o])||e.push({type:"paragraph",content:[]});let r=e.at(-1);typeof t=="string"&&(r!=null&&r.content)&&r.content.push({type:"text",text:t}),!Array.isArray(t)&&w(t)&&(r!=null&&r.content)&&r.content.push({type:"tag",attrs:{...t.attrs}}),Array.isArray(t)&&t.forEach(a=>{typeof a=="string"&&(r!=null&&r.content)&&r.content.push({type:"text",text:a}),typeof a=="object"&&a.type==="tag"&&(r!=null&&r.content)&&r.content.push({type:"tag",attrs:{...a.attrs}})})}),e}var y=require("@tiptap/react"),A=x(require("@tiptap/extension-document")),I=x(require("@tiptap/extension-paragraph")),v=x(require("@tiptap/extension-text")),N=x(require("@tiptap/extension-placeholder"));var m=require("@tiptap/core"),E=m.Node.create({name:"tag",group:"inline",inline:!0,atom:!0,selectable:!1,parseHTML(){return[{tag:`span[data-type="${this.name}"]`}]},renderHTML({HTMLAttributes:n}){return["span",(0,m.mergeAttributes)(n)]},addNodeView:()=>({node:n,extension:e})=>{let t=document.createElement("span");t.className="mi-tag";let{label:o,id:r,class:a,style:d,...c}=n.attrs;t.innerHTML=o,t.setAttribute("data-type","tag"),r&&t.setAttribute("data-id",r),e.options.tagClassName&&t.classList.add(e.options.tagClassName),a&&(Array.isArray(a)?a.forEach(p=>{t.classList.add(p)}):t.classList.add(a)),d&&Object.assign(t.style,d),Object.keys(c).length&&Object.keys(c).forEach(p=>{t.dataset[p]=c[p]}),e.options.eventHandlers&&Object.entries(e.options.eventHandlers).forEach(([p,l])=>{t.addEventListener(p,l)});let f=document.createElement("span");return f.appendChild(t),f.appendChild(document.createTextNode("\u200B")),{dom:f,destroy:()=>{e.options.eventHandlers&&Object.entries(e.options.eventHandlers).forEach(([p,l])=>{t.removeEventListener(p,l)})}}},addAttributes(){let n={};for(let e in this.options.attrs)n[e]={default:this.options.attrs[e]};return n}});var D={id:void 0,label:void 0,class:void 0,style:void 0},U=(0,u.forwardRef)((n,e)=>{let{onChange:t,value:o,placeholder:r,readonly:a=!1,tagClassName:d,editorOptions:c,className:f,tagAttrs:p,tagEventHandlers:l,...C}=n,h=(0,u.useRef)(null),i=(0,y.useEditor)({editorProps:{attributes:{class:`mix-input ${f}`}},extensions:[A.default,I.default.configure({HTMLAttributes:{class:"mi-paragraph"}}),v.default,N.default.configure({placeholder:r}),E.configure({tagClassName:d,attrs:{...D,...p},eventHandlers:l})],onUpdate:({editor:s})=>{var M;t==null||t(T(((M=s==null?void 0:s.getJSON())==null?void 0:M.content)||[]))},...c}),L=s=>{i==null||i.chain().focus().insertContent(s).run()};return(0,u.useEffect)(()=>{let s=V(o);s.length===0&&(s=[{type:"paragraph"}]),JSON.stringify(s)!==JSON.stringify(i==null?void 0:i.getJSON().content)&&(i==null||i.commands.setContent(s))},[o]),(0,u.useImperativeHandle)(e,()=>({element:h.current,editor:i,insertContent:L})),u.default.createElement(y.EditorContent,{editor:i,innerRef:h,...C})}),O=U;var _=O;
//# sourceMappingURL=index.js.map