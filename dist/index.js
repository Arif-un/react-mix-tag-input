"use client";
"use strict";var O=Object.create;var l=Object.defineProperty;var R=Object.getOwnPropertyDescriptor;var J=Object.getOwnPropertyNames;var P=Object.getPrototypeOf,S=Object.prototype.hasOwnProperty;var L=(t,a)=>{for(var e in a)l(t,e,{get:a[e],enumerable:!0})},m=(t,a,e,n)=>{if(a&&typeof a=="object"||typeof a=="function")for(let r of J(a))!S.call(t,r)&&r!==e&&l(t,r,{get:()=>a[r],enumerable:!(n=R(a,r))||n.enumerable});return t};var u=(t,a,e)=>(e=t!=null?O(P(t)):{},m(a||!t||!t.__esModule?l(e,"default",{value:t,enumerable:!0}):e,t)),v=t=>m(l({},"__esModule",{value:!0}),t);var F={};L(F,{default:()=>w});module.exports=v(F);var p=u(require("react"));function H(t){return typeof t=="object"&&t.type==="tag"}function j(t){return{type:"tag",attrs:{...t.attrs}}}function y(t){let a=[];return t.forEach(e=>{var n;e.type==="paragraph"&&(a.push([]),(n=e==null?void 0:e.content)==null||n.forEach(r=>{var s,c;r.type==="text"&&r.text&&((s=a.at(-1))==null||s.push(r.text)),r.type==="tag"&&((c=a.at(-1))==null||c.push(j(r)))}))}),a}function h(t){let a=[];return t.forEach((e,n)=>{Array.isArray(a[n])||a.push({type:"paragraph",content:[]});let r=a.at(-1);typeof e=="string"&&(r!=null&&r.content)&&r.content.push({type:"text",text:e}),!Array.isArray(e)&&H(e)&&(r!=null&&r.content)&&r.content.push({type:"tag",attrs:{...e.attrs}}),Array.isArray(e)&&e.forEach(s=>{typeof s=="string"&&(r!=null&&r.content)&&r.content.push({type:"text",text:s}),typeof s=="object"&&s.type==="tag"&&(r!=null&&r.content)&&r.content.push({type:"tag",attrs:{...s.attrs}})})}),a}var d=require("@tiptap/react"),V=u(require("@tiptap/extension-document")),b=u(require("@tiptap/extension-paragraph")),I=u(require("@tiptap/extension-text")),T=u(require("@tiptap/extension-placeholder"));var f=require("@tiptap/core"),M=f.Node.create({name:"tag",group:"inline",inline:!0,atom:!0,selectable:!1,parseHTML(){return[{tag:`span[data-type="${this.name}"]`}]},renderHTML({HTMLAttributes:t}){return["span",(0,f.mergeAttributes)(t)]},addNodeView:()=>({node:t,extension:a})=>{let e=document.createElement("span");e.className="mi-tag",e.innerHTML=t.attrs.label,e.setAttribute("data-type","tag"),t.attrs.id&&e.setAttribute("data-id",t.attrs.id),a.options.tagClassName&&e.classList.add(a.options.tagClassName),t.attrs.class&&(Array.isArray(t.attrs.class)?t.attrs.class.forEach(r=>{e.classList.add(r)}):e.classList.add(t.attrs.class)),t.attrs.style&&Object.assign(e.style,t.attrs.style);let n=document.createElement("span");return n.appendChild(e),n.appendChild(document.createTextNode("\u200B")),{dom:n}},addAttributes(){return{label:void 0,id:void 0,class:void 0,style:void 0}}});var k=(0,p.forwardRef)((t,a)=>{let{onChange:e,value:n,placeholder:r,readonly:s=!1,tagClassName:c,editorOptions:E,...A}=t,x=(0,p.useRef)(null),i=(0,d.useEditor)({editorProps:{attributes:{class:"mix-input"}},extensions:[V.default,b.default.configure({HTMLAttributes:{class:"mi-paragraph"}}),I.default,T.default.configure({placeholder:r}),M.configure({tagClassName:c})],onUpdate:({editor:o})=>{var g;e==null||e(y(((g=o==null?void 0:o.getJSON())==null?void 0:g.content)||[]))},...E}),C=o=>{i==null||i.chain().focus().insertContent(o).run()};return(0,p.useEffect)(()=>{let o=h(n);o.length===0&&(o=[{type:"paragraph"}]),JSON.stringify(o)!==JSON.stringify(i==null?void 0:i.getJSON().content)&&(console.log({updatedValueFromParent:o,value:i==null?void 0:i.getJSON().content}),i==null||i.commands.setContent(o))},[n]),(0,p.useImperativeHandle)(a,()=>({element:x.current,editor:i,insertContent:C})),p.default.createElement(d.EditorContent,{editor:i,innerRef:x,...A})}),N=k;var w=N;
//# sourceMappingURL=index.js.map