"use client";
"use strict";var R=Object.create;var l=Object.defineProperty;var P=Object.getOwnPropertyDescriptor;var J=Object.getOwnPropertyNames;var L=Object.getPrototypeOf,S=Object.prototype.hasOwnProperty;var H=(t,a)=>{for(var e in a)l(t,e,{get:a[e],enumerable:!0})},m=(t,a,e,n)=>{if(a&&typeof a=="object"||typeof a=="function")for(let r of J(a))!S.call(t,r)&&r!==e&&l(t,r,{get:()=>a[r],enumerable:!(n=P(a,r))||n.enumerable});return t};var u=(t,a,e)=>(e=t!=null?R(L(t)):{},m(a||!t||!t.__esModule?l(e,"default",{value:t,enumerable:!0}):e,t)),j=t=>m(l({},"__esModule",{value:!0}),t);var D={};H(D,{default:()=>F});module.exports=j(D);var o=u(require("react"));function v(t){return typeof t=="object"&&t.type==="tag"}function k(t){return{type:"tag",attrs:{...t.attrs}}}function y(t){let a=[];return t.forEach(e=>{var n;e.type==="paragraph"&&(a.push([]),(n=e==null?void 0:e.content)==null||n.forEach(r=>{var s,c;r.type==="text"&&r.text&&((s=a.at(-1))==null||s.push(r.text)),r.type==="tag"&&((c=a.at(-1))==null||c.push(k(r)))}))}),a}function h(t){let a=[];return t.forEach((e,n)=>{Array.isArray(a[n])||a.push({type:"paragraph",content:[]});let r=a.at(-1);typeof e=="string"&&(r!=null&&r.content)&&r.content.push({type:"text",text:e}),!Array.isArray(e)&&v(e)&&(r!=null&&r.content)&&r.content.push({type:"tag",attrs:{...e.attrs}}),Array.isArray(e)&&e.forEach(s=>{typeof s=="string"&&(r!=null&&r.content)&&r.content.push({type:"text",text:s}),typeof s=="object"&&s.type==="tag"&&(r!=null&&r.content)&&r.content.push({type:"tag",attrs:{...s.attrs}})})}),a}var f=require("@tiptap/react"),V=u(require("@tiptap/extension-document")),b=u(require("@tiptap/extension-paragraph")),I=u(require("@tiptap/extension-text")),T=u(require("@tiptap/extension-placeholder"));var d=require("@tiptap/core"),M=d.Node.create({name:"tag",group:"inline",inline:!0,atom:!0,selectable:!1,parseHTML(){return[{tag:`span[data-type="${this.name}"]`}]},renderHTML({HTMLAttributes:t}){return["span",(0,d.mergeAttributes)(t)]},addNodeView:()=>({node:t,extension:a})=>{let e=document.createElement("span");e.className="mi-tag",e.innerHTML=t.attrs.label,e.setAttribute("data-type","tag"),t.attrs.id&&e.setAttribute("data-id",t.attrs.id),a.options.tagClassName&&e.classList.add(a.options.tagClassName),t.attrs.class&&(Array.isArray(t.attrs.class)?t.attrs.class.forEach(r=>{e.classList.add(r)}):e.classList.add(t.attrs.class)),t.attrs.style&&Object.assign(e.style,t.attrs.style);let n=document.createElement("span");return n.appendChild(e),n.appendChild(document.createTextNode("\u200B")),{dom:n}},addAttributes(){return{label:void 0,id:void 0,class:void 0,style:void 0}}});var w=(0,o.forwardRef)((t,a)=>{let{onChange:e,value:n,placeholder:r,readonly:s=!1,tagClassName:c,editorOptions:E,className:A,...C}=t,x=(0,o.useRef)(null),i=(0,f.useEditor)({editorProps:{attributes:{class:`mix-input ${A}`,...C}},extensions:[V.default,b.default.configure({HTMLAttributes:{class:"mi-paragraph"}}),I.default,T.default.configure({placeholder:r}),M.configure({tagClassName:c})],onUpdate:({editor:p})=>{var g;e==null||e(y(((g=p==null?void 0:p.getJSON())==null?void 0:g.content)||[]))},...E}),O=p=>{i==null||i.chain().focus().insertContent(p).run()};return(0,o.useEffect)(()=>{let p=h(n);p.length===0&&(p=[{type:"paragraph"}]),JSON.stringify(p)!==JSON.stringify(i==null?void 0:i.getJSON().content)&&(i==null||i.commands.setContent(p))},[n]),(0,o.useImperativeHandle)(a,()=>({element:x.current,editor:i,insertContent:O})),o.default.createElement(f.EditorContent,{editor:i,innerRef:x})}),N=w;var F=N;
//# sourceMappingURL=index.js.map