"use client";
"use strict";var E=Object.create;var d=Object.defineProperty;var b=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var N=Object.getPrototypeOf,V=Object.prototype.hasOwnProperty;var H=(t,n)=>{for(var e in n)d(t,e,{get:n[e],enumerable:!0})},A=(t,n,e,u)=>{if(n&&typeof n=="object"||typeof n=="function")for(let a of h(n))!V.call(t,a)&&a!==e&&d(t,a,{get:()=>n[a],enumerable:!(u=b(n,a))||u.enumerable});return t};var S=(t,n,e)=>(e=t!=null?E(N(t)):{},A(n||!t||!t.__esModule?d(e,"default",{value:t,enumerable:!0}):e,t)),C=t=>A(d({},"__esModule",{value:!0}),t);var P={};H(P,{default:()=>D});module.exports=C(P);var l=S(require("react"));var x="mtag";function m(t){var u;if(!t)return[];let n=Array.from(t),e=[];for(let a=0;a<n.length;a+=1){let i=n[a],c=e.at(-1);if(i instanceof Node&&i.nodeName==="#text"&&i.textContent!==`
`&&i.textContent!==""&&(typeof c=="string"?e[e.length-1]=c+i.textContent:e.push(i.textContent||"")),i instanceof HTMLElement&&i.nodeName==="SPAN"){let o=(u=i==null?void 0:i.classList)==null?void 0:u.value.replace(x,"").trim();e.push({type:"tag",label:i.innerHTML||i.innerText,...o?{classes:o}:{}})}}return e}function M(t){return!Array.isArray(t)||t.length===0?"":t.reduce((n,e)=>{if(typeof e=="string")return n+=e;if(typeof e=="object"){let{label:u,classes:a}=e;return n+=`<span class="${x} ${a||""}" contenteditable="false">${u}</span>`}return""},"")}var v=(0,l.forwardRef)((t,n)=>{let{onChange:e,value:u,multiline:a,...i}=t,c=(0,l.useRef)(M(u)),o=(0,l.useRef)(null);(0,l.useEffect)(()=>{o.current&&(o.current.innerHTML=M(u))},[u]);let R=r=>{var y,I,T;let p=window.getSelection();if(!p)return;let f=p.getRangeAt(0);if(f.commonAncestorContainer!==o.current&&f.commonAncestorContainer.parentElement!==o.current)return;f.deleteContents();let s;if(typeof r=="string"?(s=document.createTextNode(r),s.textContent=r):typeof r=="object"&&r.type==="tag"&&(s=document.createElement("span"),s.classList.add(x),r.classes&&s.classList.add(r.classes),s.setAttribute("contentEditable","false"),s.innerHTML=r.label),!s){console.error("invalid content");return}f.insertNode(s);let g=document.createRange();g.setStartAfter(s),g.setEndAfter(s),p.removeAllRanges(),p.addRange(g),(y=o.current)==null||y.focus(),c.current=((I=o.current)==null?void 0:I.innerHTML)??"",e==null||e(m((T=o.current)==null?void 0:T.childNodes))};return(0,l.useImperativeHandle)(n,()=>({inputRef:o.current,insertContent:R,getValue:()=>{var r;return m((r=o.current)==null?void 0:r.childNodes)}})),l.default.createElement("div",{"aria-label":"input",role:"textbox",tabIndex:0,className:"mix-tag-input",contentEditable:!0,ref:o,onInput:()=>{var r;o.current&&(c.current=o.current.innerHTML),e==null||e(m((r=o.current)==null?void 0:r.childNodes))},onKeyDown:r=>{r.key==="Enter"&&!a&&r.preventDefault()},dangerouslySetInnerHTML:{__html:c.current},...a?{"aria-multiline":!0}:{},...i})}),L=v;var D=L;
//# sourceMappingURL=index.js.map